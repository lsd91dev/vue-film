(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f0e68bf"],{"0c9d":function(e,t,r){},"18ea":function(e,t,r){"use strict";r("e772")},"1dde":function(e,t,r){var n=r("d039"),a=r("b622"),i=r("2d00"),s=a("species");e.exports=function(e){return i>=51||!n((function(){var t=[],r=t.constructor={};return r[s]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var n=r("1d80"),a=r("5899"),i="["+a+"]",s=RegExp("^"+i+i+"*"),o=RegExp(i+i+"*$"),c=function(e){return function(t){var r=String(n(t));return 1&e&&(r=r.replace(s,"")),2&e&&(r=r.replace(o,"")),r}};e.exports={start:c(1),end:c(2),trim:c(3)}},7156:function(e,t,r){var n=r("861d"),a=r("d2bb");e.exports=function(e,t,r){var i,s;return a&&"function"==typeof(i=t.constructor)&&i!==r&&n(s=i.prototype)&&s!==r.prototype&&a(e,s),e}},"79eb":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"reviewForm"},[r("b-row",[r("b-col",{staticClass:"m-auto",attrs:{lg:"8",sm:"8"}},[r("b-alert",{attrs:{show:e.submit,variant:e.error.updated?"success":"danger"}},[r("p",{staticClass:"h4 alert-heading"},[e._v(e._s(e.error.updated?"Your review has been created successfully":"Your review cannot be created!"))]),e.error.updated?e._e():e._l(e.error.msg,(function(t,n){return r("p",{key:n},[e._v(" "+e._s(t)+" ")])}))],2),r("b-form",{on:{submit:function(t){return t.preventDefault(),e.send(t)}}},[r("b-form-group",{attrs:{id:"input-group-username",label:"Username","label-for":"input-username",description:""==e.review.username?"Required":""}},[r("b-form-input",{staticClass:"vf-only-bottom-border vf-input-focus",attrs:{id:"input-username",type:"text"},model:{value:e.review.username,callback:function(t){e.$set(e.review,"username",t)},expression:"review.username"}}),e.review.username?[r("b-tooltip",{attrs:{target:"input-username",triggers:"focus"}},[e._v(" If you change this, your username will be "),r("b",[e._v("updated")]),e._v("! ")])]:e._e(),e.user.username!=e.review.username?r("b-form-checkbox",{staticClass:"mb-3 mt-4",attrs:{"value-field":"acepted","text-field":"name",state:e.checkUsername,"disabled-field":"notEnabled"},model:{value:e.checkUsername,callback:function(t){e.checkUsername=t},expression:"checkUsername"}},[e._v("I'm sure I want to update my username")]):e._e(),e.submit&&!e.checkUserUsernameEqualsReviewUsername()?r("b-form-invalid-feedback",{attrs:{state:e.checkUsername}},[e._v("You have to accept!")]):e._e()],2),r("b-form-textarea",{attrs:{id:"textarea-no-resize",placeholder:"Tell us your opinion",rows:"3","no-resize":"",required:""},model:{value:e.review.content,callback:function(t){e.$set(e.review,"content",t)},expression:"review.content"}}),r("b-form-group",{staticClass:"mt-3"},[r("b-button",{staticClass:"mr-2",attrs:{type:"submit"}},[e._v("Send")])],1)],1)],1)],1)],1)},a=[],i=(r("99af"),r("96cf"),r("1da1")),s="http://localhost:3000/vfilm",o={name:"Review-form",data:function(){return{checkUsername:!1,submit:!1,error:{updated:!1,msg:""},user:"",review:{username:"",content:""},review_id:this.$route.params.review_id,movie_id:this.$route.params.movie_id}},props:{type:String},created:function(){this.init()},methods:{init:function(){this.getUser()},getUser:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.axios.get("".concat(s,"/user/profile"),{headers:{authorization:e.token}});case 3:r=t.sent,e.user=r.data.user,e.getUsername(),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},send:function(){if(this.submit=!0,this.user.username==this.review.username)switch(this.type){case"Send":this.sendReview();break;case"Update":this.updateReview();break}else if(this.checkUsername)switch(this.type){case"Send":this.sendReview();break;case"Update":this.updateReview();break}else{var e={msg:"You must accept!"};this.error.msg=e}},sendReview:function(){var e=this;this.axios.post("".concat(s,"/review/movie/").concat(this.movie_id),this.review,{headers:{authorization:this.token}}).then((function(t){t.data.token&&e.$store.dispatch("refreshToken",t.data.token).then((function(){})).catch((function(e){console.log(e)})),e.error.updated=!0,setTimeout((function(){return e.$router.go("-1")}),800)})).catch((function(t){e.error.updated=!1,e.error.msg=t.response.data.errors.msg,console.log(e.error.msg)}))},updateReview:function(){var e=this;this.axios.put("".concat(s,"/review/").concat(this.review_id),this.review,{headers:{authorization:this.token}}).then((function(t){t.data.token&&e.$store.dispatch("refreshToken",t.data.token).then((function(){})).catch((function(e){console.log(e)})),e.error.updated=!0,setTimeout((function(){return e.$router.go("-1")}),800)})).catch((function(t){e.error.updated=!1,e.error.msg&&(e.error.msg=t.response.data.errors.msg)}))},checkUserUsernameEqualsReviewUsername:function(){return this.user.username==this.review.username},getUsername:function(){this.review.username=this.user.username}},computed:{token:function(){return this.$store.getters.isAuth}}},c=o,u=(r("9451"),r("2877")),d=Object(u["a"])(c,n,a,!1,null,"7fd99a72",null);t["a"]=d.exports},8418:function(e,t,r){"use strict";var n=r("c04e"),a=r("9bf2"),i=r("5c6c");e.exports=function(e,t,r){var s=n(t);s in e?a.f(e,s,i(0,r)):e[s]=r}},9451:function(e,t,r){"use strict";r("0c9d")},"99af":function(e,t,r){"use strict";var n=r("23e7"),a=r("d039"),i=r("e8b5"),s=r("861d"),o=r("7b0b"),c=r("50c4"),u=r("8418"),d=r("65f0"),l=r("1dde"),f=r("b622"),v=r("2d00"),h=f("isConcatSpreadable"),m=9007199254740991,p="Maximum allowed index exceeded",w=v>=51||!a((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),b=l("concat"),g=function(e){if(!s(e))return!1;var t=e[h];return void 0!==t?!!t:i(e)},_=!w||!b;n({target:"Array",proto:!0,forced:_},{concat:function(e){var t,r,n,a,i,s=o(this),l=d(s,0),f=0;for(t=-1,n=arguments.length;t<n;t++)if(i=-1===t?s:arguments[t],g(i)){if(a=c(i.length),f+a>m)throw TypeError(p);for(r=0;r<a;r++,f++)r in i&&u(l,f,i[r])}else{if(f>=m)throw TypeError(p);u(l,f++,i)}return l.length=f,l}})},a9e3:function(e,t,r){"use strict";var n=r("83ab"),a=r("da84"),i=r("94ca"),s=r("6eeb"),o=r("5135"),c=r("c6b6"),u=r("7156"),d=r("c04e"),l=r("d039"),f=r("7c73"),v=r("241c").f,h=r("06cf").f,m=r("9bf2").f,p=r("58a8").trim,w="Number",b=a[w],g=b.prototype,_=c(f(g))==w,k=function(e){var t,r,n,a,i,s,o,c,u=d(e,!1);if("string"==typeof u&&u.length>2)if(u=p(u),t=u.charCodeAt(0),43===t||45===t){if(r=u.charCodeAt(2),88===r||120===r)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:n=2,a=49;break;case 79:case 111:n=8,a=55;break;default:return+u}for(i=u.slice(2),s=i.length,o=0;o<s;o++)if(c=i.charCodeAt(o),c<48||c>a)return NaN;return parseInt(i,n)}return+u};if(i(w,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var x,y=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof y&&(_?l((function(){g.valueOf.call(r)})):c(r)!=w)?u(new b(k(t)),r,y):k(t)},R=n?v(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),C=0;R.length>C;C++)o(b,x=R[C])&&!o(y,x)&&m(y,x,h(b,x));y.prototype=g,g.constructor=y,s(a,w,y)}},aa29:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"reviewUpdate"},[r("div",{staticClass:"ml-5 mr-5 mt-5"},[r("p",{staticClass:"h1"},[e._v(" Your preview review")]),r("b-row",{staticClass:"mt-5"},[r("b-col",{staticClass:"m-auto",attrs:{lg:"8",sm:"8"}},[r("b-card",{attrs:{"border-variant":"secondary",header:e.review.movie_title,"header-border-variant":"secondary"}},[r("b-card-text",[e._v(e._s(e.review.content))])],1)],1)],1)],1),r("div",{staticClass:"ml-5 mr-5 mt-5"},[r("p",{staticClass:"h1"},[e._v(" Update your review ")]),r("ReviewForm",{attrs:{type:e.type}})],1)])},a=[],i=(r("99af"),r("c69e")),s=r("79eb"),o="http://localhost:3000/vfilm",c={name:"Review-update",data:function(){return{review_id:this.$route.params.review_id,review:"",type:"Update"}},components:{ReviewCard:i["a"],ReviewForm:s["a"]},created:function(){this.init()},methods:{init:function(){this.getReview()},getReview:function(){var e=this;this.axios.get("".concat(o,"/review/").concat(this.review_id)).then((function(t){e.review=t.data.review})).catch((function(e){console.log(e.data)}))}}},u=c,d=r("2877"),l=Object(d["a"])(u,n,a,!1,null,null,null);t["default"]=l.exports},c69e:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"reviewCard"},[r("b-container",[r("b-alert",{attrs:{show:e.submit,variant:e.error.deleted?"success":"danger"}},[e._v(e._s(e.error.deleted?"Review successfully deleted":e.error.msg))])],1),0!=e.reviews.length?e._l(e.reviews,(function(t,n){return r("b-card",{key:n,staticClass:"m-3",class:e.user._id==t.user_id?"app-review-card":"",attrs:{"border-variant":"secondary","header-border-variant":"secondary",header:t.username}},[r("b-card-text",{staticClass:"text-justify"},[e._v(" "+e._s(t.content)+" ")]),e.user._id==t.user_id?r("b-button",{staticClass:"app-button-review-card",attrs:{variant:"info"},on:{click:function(r){return e.updateReview(t._id)}}},[r("b-icon",{attrs:{icon:"pencil-square"}}),e._v("Update your review")],1):e._e(),e.user._id==t.user_id?r("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.confirm-delete",modifiers:{"confirm-delete":!0}}],staticClass:"app-button-review-card app-margin-left",attrs:{variant:"danger"}},[r("b-icon",{attrs:{icon:"trash"}}),e._v("Delete")],1):e._e(),e.user._id==t.user_id?r("b-modal",{attrs:{id:"confirm-delete"},on:{ok:function(r){return e.deleteReview(t._id)}}},[r("p",{staticClass:"my-4"},[e._v("Are you sure you want to delete this review?")])]):e._e()],1)})):[r("p",{staticClass:"text-center"},[e._v(" There are no reviews availables ")])]],2)},a=[],i=(r("99af"),r("a9e3"),"http://localhost:3000/vfilm"),s={name:"ReviewCard",data:function(){return{reviews:"",user:"",submit:!1,error:{deleted:Boolean,msg:String}}},props:{movie_id:String|Number,token:String},created:function(){this.init()},methods:{init:function(){this.getReviews(),this.getUser()},getReviews:function(){var e=this;this.axios.get("".concat(i,"/review/for/").concat(this.movie_id)).then((function(t){e.reviews=t.data.reviews})).catch((function(e){console.log(e.response)}))},getUser:function(){var e=this;this.token&&this.axios.get("".concat(i,"/user"),{headers:{authorization:this.token}}).then((function(t){e.user=t.data.user})).catch((function(e){console.log(e)}))},updateReview:function(e){this.$router.push({path:"/review/update/".concat(e)})},deleteReview:function(e){var t=this;this.submit=!0,this.axios.delete("".concat(i,"/review/").concat(e),{headers:{authorization:this.token}}).then((function(e){t.error.deleted=!0,setTimeout((function(){return t.$router.push({path:"/"})}),800)})).catch((function(e){console.log(e.response),t.error.deleted=!1,t.error.msg=e.response.data.errors.msg}))}}},o=s,c=(r("18ea"),r("2877")),u=Object(c["a"])(o,n,a,!1,null,"8da1b86c",null);t["a"]=u.exports},e772:function(e,t,r){}}]);
//# sourceMappingURL=chunk-4f0e68bf.8b3b59a9.js.map